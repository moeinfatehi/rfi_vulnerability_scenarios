<?php
    if( !ini_get('allow_url_include') ) {
        echo "Please enable allow_url_include in php.ini file";
    }
//Need to enable allow_url_include in php.ini file
?>

<!DOCTYPE html>
<html>
<head>
    <title>RFI 2</title>
    <link rel="stylesheet" href="../static/css/bootstrap.min.css" />
</head>
    <body>
        <div id="main">
            <div class="container">
                    <div class="row">
                        <h1>RFI</h1>
                    </div>
                    <div class="row">
                        <p class="lead">
                            go far from local.<br />
                        </p>
                    </div>
                </div>
            </div>
            <div class="container">

                    <div class="row">
                        <form name="LoginForm" method="post">
                            <div class="form-group col-md-2">
                            </div>
                        </form>
                    </div>
<?php
    $f='flag.php';
    echo "<a class=\"btn btn-primary\" href=\".?file=$f\" /> Include the file </a><br><br>";
    $incfile=$_GET['file'];
    if($incfile){
        if (stripos($incfile, "filter") === false && stripos($incfile, "index.php") === false&& stripos($incfile, "../") === false) {
            include($incfile);
        }
        else{
            echo "Forget LFI, try RFI!";
        }
    }
?>

<?php
if (isset ($_POST['submit']) && isset ($_POST['flag'])) {
	$user_flag = $_POST['flag'];
	if ($user_flag==$flag) { ?>
	<div class="row">
            <p style="color:green;" class="well"><strong></strong><?php
                include("flag.php");
                echo "Correct, Flag is: ".$flag; ?> </p>
            </p>
        </div>
<?php
	}
	else{ ?>
	<div class="row">
            <p style="color:red;" class="well"><strong></strong><?php echo "Incorrect flag";?></p>
            </p>
        </div>
<?php
	}
}

?>
                </div>
            </div>
        </div>
        <script type="text/javascript" src="../static/css/bootstrap.min.js"></script>
    </body>
</html>
<?php
include ("../footer.php");
?>
<!--Moein Fatehi